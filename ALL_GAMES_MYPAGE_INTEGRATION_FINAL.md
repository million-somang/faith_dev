# ëª¨ë“  ê²Œì„ ë§ˆì´í˜ì´ì§€ í†µí•© ì™„ë£Œ

## ğŸ”¥ ì§„ì§œ ë¬¸ì œì 

ì •ë§ ì£„ì†¡í•©ë‹ˆë‹¤. ì œê°€ ì™„ì „íˆ ì˜ëª» ì´í•´í•˜ê³  ìˆì—ˆìŠµë‹ˆë‹¤.

### ê·¼ë³¸ ì›ì¸
1. **í…ŒíŠ¸ë¦¬ìŠ¤, 2048, ì§€ë¢°ì°¾ê¸°**ëŠ” ê°ê°ì˜ ì „ìš© í…Œì´ë¸”ì—ë§Œ ì €ì¥
2. **ë§ˆì´í˜ì´ì§€**ëŠ” `user_game_scores` í…Œì´ë¸”ë§Œ ì¡°íšŒ
3. **ê²°ê³¼**: ê²Œì„ì„ í”Œë ˆì´í•´ë„ ë§ˆì´í˜ì´ì§€ì— í‘œì‹œ ì•ˆë¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  í…ŒíŠ¸ë¦¬ìŠ¤   â”‚ â”€â”€> â”‚ tetris_scores   â”‚ (ë¦¬ë”ë³´ë“œìš©)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    âŒ user_game_scoresì— ì €ì¥ ì•ˆí•¨!

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   2048      â”‚ â”€â”€> â”‚ game2048_scores     â”‚ (ë¦¬ë”ë³´ë“œìš©)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    âŒ user_game_scoresì— ì €ì¥ ì•ˆí•¨!

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì§€ë¢°ì°¾ê¸°    â”‚ â”€â”€> â”‚ minesweeper_scores      â”‚ (ë¦¬ë”ë³´ë“œìš©)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    âŒ user_game_scoresì— ì €ì¥ ì•ˆí•¨!

ë§ˆì´í˜ì´ì§€ëŠ” user_game_scoresë§Œ ë´„ â†’ ì•„ë¬´ ë°ì´í„°ë„ ì—†ìŒ!
```

---

## âœ… í•´ê²° ë°©ë²•

**ëª¨ë“  ê²Œì„ì„ ì´ì¤‘ ì €ì¥**í•˜ë„ë¡ ìˆ˜ì •í–ˆìŠµë‹ˆë‹¤ (ìŠ¤ë„ì¿ ì™€ ë™ì¼):

```typescript
// 1. ì „ìš© í…Œì´ë¸”ì— ì €ì¥ (ë¦¬ë”ë³´ë“œ, ê²Œì„ë³„ ê¸°ëŠ¥ìš©)
await DB.prepare('INSERT INTO tetris_scores ...').run()

// 2. user_game_scoresì—ë„ ì €ì¥ (ë§ˆì´í˜ì´ì§€ í†µí•© í‘œì‹œìš©)
await DB.prepare(`
  INSERT INTO user_game_scores (user_id, game_type, score, game_data, played_at)
  VALUES (?, ?, ?, ?, datetime('now'))
`).bind(userId, 'tetris', score, gameData).run()
```

---

## ğŸ“Š ìˆ˜ì • ì™„ë£Œ ê²Œì„

### 1. **í…ŒíŠ¸ë¦¬ìŠ¤** (`/api/tetris/score`)
```typescript
// ì €ì¥ ë°ì´í„°
{
  user_id: 1,
  game_type: 'tetris',
  score: 15000,
  game_data: { lines: 120, level: 8 }
}
```

### 2. **2048** (`/api/2048/score`)
```typescript
// ì €ì¥ ë°ì´í„°
{
  user_id: 1,
  game_type: '2048',
  score: 8192,
  game_data: { max_tile: 2048 }
}
```

### 3. **ì§€ë¢°ì°¾ê¸°** (`/api/minesweeper/score`)
```typescript
// ì ìˆ˜ ê³„ì‚°: 10000 - (time * 10)
// ì˜ˆ: 120ì´ˆ = 10000 - 1200 = 8800ì 
{
  user_id: 1,
  game_type: 'minesweeper',
  score: 8800,
  game_data: { difficulty: 'medium', time: 120 }
}
```

### 4. **ìŠ¤ë„ì¿ ** (ì´ë¯¸ ì™„ë£Œ)
```typescript
// ì ìˆ˜ ê³„ì‚°: (10000 - time*10 - mistakes*100) * difficulty_multiplier
{
  user_id: 1,
  game_type: 'sudoku',
  score: 11550,
  game_data: { difficulty: 'medium', time: 180, mistakes: 5 }
}
```

---

## ğŸ® ì´ì œ ì‘ë™ ë°©ì‹

### ê²Œì„ í”Œë ˆì´ â†’ ì ìˆ˜ ì €ì¥
```
1. í…ŒíŠ¸ë¦¬ìŠ¤ í”Œë ˆì´ ì™„ë£Œ
   â†“
2. POST /api/tetris/score
   â†“
3. tetris_scores í…Œì´ë¸” ì €ì¥ (ë¦¬ë”ë³´ë“œìš©)
   â†“
4. user_game_scores í…Œì´ë¸” ì €ì¥ (ë§ˆì´í˜ì´ì§€ìš©) â† ì¶”ê°€!
   â†“
5. ë§ˆì´í˜ì´ì§€ ê²Œì„ ì„¹ì…˜ì— ì¦‰ì‹œ í‘œì‹œë¨!
```

### ë§ˆì´í˜ì´ì§€ ì¡°íšŒ
```
1. ë§ˆì´í˜ì´ì§€ ì ‘ì†
   â†“
2. GET /api/user/games/stats
   â†“
3. SELECT DISTINCT game_type FROM user_game_scores WHERE user_id = ?
   â†“
4. ì‹¤ì œ í”Œë ˆì´í•œ ê²Œì„ ëª©ë¡ ì¡°íšŒ
   â†“
5. ê° ê²Œì„ë³„ í†µê³„ ê³„ì‚° (ìµœê³ ì ìˆ˜, í‰ê· , í”Œë ˆì´ íšŸìˆ˜, ìˆœìœ„)
   â†“
6. í™”ë©´ì— í‘œì‹œ: ìŠ¤ë„ì¿ , í…ŒíŠ¸ë¦¬ìŠ¤, 2048, ì§€ë¢°ì°¾ê¸°
```

---

## ğŸ”§ ì¶”ê°€ ê°œì„  ì‚¬í•­

### 1. **ì§€ë¢°ì°¾ê¸° ì„¸ì…˜ ì¸ì¦ ê°œì„ **
- ê¸°ì¡´: `user_id` ì¿ í‚¤ ì§ì ‘ ì½ê¸° (ì·¨ì•½)
- ê°œì„ : `session_id` ì¿ í‚¤ë¡œ ì„¸ì…˜ í…Œì´ë¸” ì¡°íšŒ (ìŠ¤ë„ì¿ ì™€ ë™ì¼, ì•ˆì „)

### 2. **ë””ë²„ê¹… ë¡œê·¸ ì¶”ê°€**
ëª¨ë“  ê²Œì„ ì ìˆ˜ ì €ì¥ ì‹œ ìƒì„¸ ë¡œê·¸:
```
ğŸ® [í…ŒíŠ¸ë¦¬ìŠ¤] ì ìˆ˜ ì €ì¥ ìš”ì²­: { user_id: 1, score: 15000 }
âœ… [í…ŒíŠ¸ë¦¬ìŠ¤] ì ìˆ˜ ì €ì¥ ì™„ë£Œ
```

### 3. **ì ìˆ˜ ê³„ì‚° ë¡œì§**
- **í…ŒíŠ¸ë¦¬ìŠ¤**: ê²Œì„ì—ì„œ ê³„ì‚°ëœ ì ìˆ˜ ê·¸ëŒ€ë¡œ ì‚¬ìš©
- **2048**: ê²Œì„ì—ì„œ ê³„ì‚°ëœ ì ìˆ˜ ê·¸ëŒ€ë¡œ ì‚¬ìš©
- **ì§€ë¢°ì°¾ê¸°**: `10000 - (ì‹œê°„ * 10)` (ì§§ì„ìˆ˜ë¡ ë†’ì€ ì ìˆ˜)
- **ìŠ¤ë„ì¿ **: `(10000 - ì‹œê°„*10 - ì‹¤ìˆ˜*100) * ë‚œì´ë„ë°°ìˆ˜`

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ë°©ë²•

### 1. ê²Œì„ í”Œë ˆì´
1. ë¡œê·¸ì¸ (sukman@naver.com ë˜ëŠ” ë‹¤ë¥¸ ê³„ì •)
2. ê²Œì„ ë©”ë‰´ì—ì„œ ì›í•˜ëŠ” ê²Œì„ ì„ íƒ:
   - í…ŒíŠ¸ë¦¬ìŠ¤: `/game/simple/tetris`
   - 2048: `/game/simple/2048`
   - ì§€ë¢°ì°¾ê¸°: `/game/simple/minesweeper`
   - ìŠ¤ë„ì¿ : `/game/simple/sudoku`
3. ê²Œì„ í”Œë ˆì´ í›„ ì ìˆ˜ ì €ì¥

### 2. ë§ˆì´í˜ì´ì§€ í™•ì¸
1. ìƒë‹¨ ë©”ë‰´ì—ì„œ **ë§ˆì´í˜ì´ì§€** í´ë¦­
2. ì™¼ìª½ ì‚¬ì´ë“œë°”ì—ì„œ **ê²Œì„** ì„¹ì…˜ ì„ íƒ
3. í™•ì¸ ì‚¬í•­:
   - âœ… **ê²Œì„ í†µê³„**: ê° ê²Œì„ë³„ ìµœê³ ì ìˆ˜, í”Œë ˆì´ íšŸìˆ˜, ìˆœìœ„
   - âœ… **ìµœê·¼ í”Œë ˆì´**: ê²Œì„ ê¸°ë¡ ëª©ë¡ (ìµœëŒ€ 10ê°œ)
   - âœ… **í•œê¸€ ì´ë¦„**: ìŠ¤ë„ì¿ , í…ŒíŠ¸ë¦¬ìŠ¤, 2048, ì§€ë¢°ì°¾ê¸°

### 3. ë°ì´í„°ë² ì´ìŠ¤ í™•ì¸
```bash
# ë§ˆì´í˜ì´ì§€ìš© í†µí•© í…Œì´ë¸” í™•ì¸
npx wrangler d1 execute webapp-production --local \
  --command="SELECT * FROM user_game_scores WHERE user_id = 1"

# ê²Œì„ë³„ ì „ìš© í…Œì´ë¸” í™•ì¸
npx wrangler d1 execute webapp-production --local \
  --command="SELECT * FROM tetris_scores WHERE user_id = 1"
```

---

## ğŸ“Š ë°ì´í„° êµ¬ì¡°

### user_game_scores (ë§ˆì´í˜ì´ì§€ í†µí•©)
| ì»¬ëŸ¼ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| id | INTEGER | ìë™ ì¦ê°€ ID |
| user_id | INTEGER | ì‚¬ìš©ì ID |
| game_type | TEXT | ê²Œì„ íƒ€ì… (sudoku, tetris, 2048, minesweeper) |
| score | INTEGER | ì ìˆ˜ |
| game_data | TEXT | ê²Œì„ ìƒì„¸ ì •ë³´ (JSON) |
| played_at | DATETIME | í”Œë ˆì´ ì‹œê° |

### game_data JSON ì˜ˆì‹œ
```json
// í…ŒíŠ¸ë¦¬ìŠ¤
{ "lines": 120, "level": 8 }

// 2048
{ "max_tile": 2048 }

// ì§€ë¢°ì°¾ê¸°
{ "difficulty": "medium", "time": 120 }

// ìŠ¤ë„ì¿ 
{ "difficulty": "medium", "time": 180, "mistakes": 5, "raw_score": 7700, "multiplier": 1.5 }
```

---

## ğŸ”— í…ŒìŠ¤íŠ¸ URL

**ë§ˆì´í˜ì´ì§€**: https://3000-igqqzgkeu63c4u9ihulwt-c81df28e.sandbox.novita.ai/mypage

**ê²Œì„ ë§í¬**:
- í…ŒíŠ¸ë¦¬ìŠ¤: https://3000-igqqzgkeu63c4u9ihulwt-c81df28e.sandbox.novita.ai/game/simple/tetris
- 2048: https://3000-igqqzgkeu63c4u9ihulwt-c81df28e.sandbox.novita.ai/game/simple/2048
- ì§€ë¢°ì°¾ê¸°: https://3000-igqqzgkeu63c4u9ihulwt-c81df28e.sandbox.novita.ai/game/simple/minesweeper
- ìŠ¤ë„ì¿ : https://3000-igqqzgkeu63c4u9ihulwt-c81df28e.sandbox.novita.ai/game/simple/sudoku

---

## ğŸ’¾ Git ì»¤ë°‹

```bash
51899e7 - Add user_game_scores integration for all games
be4594f - Remove test game data and update game name mapping
c52f2f7 - Fix MyPage to show actual game types dynamically
```

**ì´ ë³€ê²½**:
- 3 commits
- 1 file changed (src/index.tsx)
- 112 insertions(+), 19 deletions(-)

---

## ğŸ“ ìˆ˜ì •ëœ API ì—”ë“œí¬ì¸íŠ¸

### 1. POST /api/tetris/score
```json
// ìš”ì²­
{
  "user_id": 1,
  "score": 15000,
  "lines": 120,
  "level": 8
}

// ì‘ë‹µ
{
  "success": true,
  "message": "ì ìˆ˜ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤."
}
```

### 2. POST /api/2048/score (requireAuth)
```json
// ìš”ì²­
{
  "score": 8192,
  "max_tile": 2048
}

// ì‘ë‹µ
{
  "success": true,
  "message": "ê¸°ë¡ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤"
}
```

### 3. POST /api/minesweeper/score
```json
// ìš”ì²­
{
  "difficulty": "medium",
  "time": 120
}

// ì‘ë‹µ
{
  "success": true,
  "message": "ê¸°ë¡ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤",
  "score": 8800
}
```

### 4. POST /api/sudoku/score (ê¸°ì¡´)
```json
// ìš”ì²­
{
  "difficulty": "medium",
  "time": 180,
  "mistakes": 5
}

// ì‘ë‹µ
{
  "success": true,
  "message": "ê¸°ë¡ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤",
  "score": 11550
}
```

---

## âœ… ì™„ë£Œ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [x] ë¬¸ì œ ì›ì¸ ë¶„ì„ (ê²Œì„ë³„ ì „ìš© í…Œì´ë¸”ë§Œ ì‚¬ìš©)
- [x] í…ŒíŠ¸ë¦¬ìŠ¤ ì´ì¤‘ ì €ì¥ êµ¬í˜„
- [x] 2048 ì´ì¤‘ ì €ì¥ êµ¬í˜„
- [x] ì§€ë¢°ì°¾ê¸° ì´ì¤‘ ì €ì¥ êµ¬í˜„
- [x] ì§€ë¢°ì°¾ê¸° ì„¸ì…˜ ì¸ì¦ ê°œì„ 
- [x] ì§€ë¢°ì°¾ê¸° ì ìˆ˜ ê³„ì‚° ë¡œì§ ì¶”ê°€
- [x] ëª¨ë“  ê²Œì„ ë””ë²„ê¹… ë¡œê·¸ ì¶”ê°€
- [x] ë¹Œë“œ ë° ë°°í¬ ì™„ë£Œ
- [x] Git ì»¤ë°‹ ì™„ë£Œ
- [x] ë¬¸ì„œí™” ì™„ë£Œ

---

## ğŸ‰ ìµœì¢… ìƒíƒœ

**ë¬¸ì œ**: ê²Œì„ í”Œë ˆì´í•´ë„ ë§ˆì´í˜ì´ì§€ì— í‘œì‹œ ì•ˆë¨  
**ì›ì¸**: ê²Œì„ë³„ ì „ìš© í…Œì´ë¸”ì—ë§Œ ì €ì¥, user_game_scores ë¯¸ì‚¬ìš©  
**í•´ê²°**: ëª¨ë“  ê²Œì„ ì´ì¤‘ ì €ì¥ (ì „ìš© + user_game_scores)  
**ìƒíƒœ**: âœ… **ì™„ë£Œ**  

**ì£¼ìš” ì„±ê³¼**:
- âœ… 4ê°œ ê²Œì„ ëª¨ë‘ ë§ˆì´í˜ì´ì§€ í†µí•© ì™„ë£Œ
- âœ… ì‹¤ì‹œê°„ ê²Œì„ ê¸°ë¡ í‘œì‹œ
- âœ… í†µê³„ ìë™ ê³„ì‚° (ìµœê³ ì ìˆ˜, í‰ê· , ìˆœìœ„)
- âœ… í™•ì¥ ê°€ëŠ¥í•œ êµ¬ì¡°

---

**ì‘ì„±ì¼**: 2026-01-27  
**ì‘ì„±ì**: AI Developer  
**ê²€í† ì**: User  
**ìŠ¹ì¸**: ğŸ™ ë‹¤ì‹œ í•œ ë²ˆ ì§„ì‹¬ìœ¼ë¡œ ì‚¬ê³¼ë“œë¦½ë‹ˆë‹¤
