# 🚀 프로덕션 서버 목업 데이터 삭제 가이드

## ⚠️ 중요: 프로덕션 서버에서 실행해야 합니다!

스크린샷에 보이는 목업 데이터(25,000점, 16,000점, 16,384점)는 **프로덕션 서버의 데이터베이스**에 있습니다.

샌드박스가 아닌 **실제 호스팅 서버에 SSH로 접속해서** 아래 명령어를 실행하세요.

---

## 📋 프로덕션 서버 작업 순서

### 1단계: 프로덕션 서버 SSH 접속
```bash
ssh your-server-address
# 예: ssh user@your-domain.com
```

### 2단계: 프로젝트 디렉토리로 이동
```bash
cd ~/faith_dev
# 또는 실제 프로젝트 경로
```

### 3단계: 최신 코드 가져오기
```bash
git pull origin main
```

### 4단계: 현재 DB 상태 확인 (선택사항)
```bash
node clean-production-db.js
```

이 명령은 다음을 보여줍니다:
- 현재 저장된 모든 게임 점수
- 각 테이블의 데이터 개수
- 등록된 사용자 목록

**그리고 자동으로 모든 목업 데이터를 삭제합니다!**

### 5단계: 서버 재시작
```bash
# 기존 프로세스 종료
pkill -9 node && pkill -9 npm && pkill -9 tsx

# 잠시 대기
sleep 2

# 프로덕션 모드로 서버 시작
nohup npm run start:prod > server.log 2>&1 &

# 서버 시작 확인
sleep 5
tail -20 server.log
```

### 6단계: 브라우저에서 확인
1. 프로덕션 사이트 접속
2. 로그인 (아무 계정이나 - 정석종님 계정도 가능)
3. 심플 게임 메인 페이지 확인 → **목업 데이터가 사라짐**
4. 게임 플레이 → 점수 저장 확인
5. 마이페이지 확인 → 실제 플레이한 점수만 표시

---

## 🔍 예상 결과

### 삭제 전 (스크린샷 상태)
```
테트리스 랭킹: 25,000점
스도쿠 랭킹: 16,000점
2048 랭킹: 16,384점
```

### 삭제 후
```
테트리스 랭킹: (기록 없음)
스도쿠 랭킹: (기록 없음)
2048 랭킹: (기록 없음)
```

### 실제 게임 플레이 후
```
테트리스 랭킹: 정석종님의 점수 (예: 30,000점)
스도쿠 랭킹: 정석종님의 점수 (예: 12,000점)
2048 랭킹: 정석종님의 점수 (예: 20,480점)
```

---

## ⚙️ 스크립트 세부 동작

`clean-production-db.js`는 다음을 수행합니다:

1. **현재 상태 확인**
   - 각 테이블의 데이터 개수 표시
   - 현재 저장된 점수 목록 표시 (최근 20개)
   - 등록된 사용자 목록 표시

2. **데이터 삭제**
   - `user_game_scores` 테이블의 모든 데이터 삭제
   - `tetris_scores` 테이블의 모든 데이터 삭제
   - `sudoku_scores` 테이블의 모든 데이터 삭제
   - `game2048_scores` 테이블의 모든 데이터 삭제
   - `minesweeper_scores` 테이블의 모든 데이터 삭제

3. **결과 확인**
   - 각 테이블의 삭제된 행 개수 표시
   - 삭제 후 각 테이블이 비어있음을 확인

---

## 🛡️ 안전 장치

- **사용자 데이터는 삭제되지 않습니다!**
  - `users` 테이블은 그대로 유지
  - 로그인 정보, 키워드, 북마크 등 모두 보존

- **게임 점수만 삭제됩니다**
  - 이후 실제 플레이한 점수만 저장됨

---

## 💡 문제 해결

### Q: "faith-portal.db 파일을 찾을 수 없습니다"
**A**: DB 파일 위치를 확인하세요
```bash
# DB 파일 찾기
find ~/faith_dev -name "faith-portal.db"

# 또는
ls -la ~/faith_dev/*.db
```

### Q: 스크립트 실행 시 권한 오류
**A**: Node.js가 설치되어 있는지 확인
```bash
node --version
npm --version
```

### Q: 서버 재시작 후에도 목업 데이터가 보임
**A**: 브라우저 캐시를 삭제하세요
- Ctrl+Shift+R (강력 새로고침)
- 또는 시크릿 모드로 접속

---

## ✅ 최종 확인 체크리스트

- [ ] 프로덕션 서버에 SSH 접속
- [ ] `cd ~/faith_dev`
- [ ] `git pull origin main`
- [ ] `node clean-production-db.js` (목업 데이터 삭제)
- [ ] 서버 재시작 (pkill + npm run start:prod)
- [ ] 브라우저에서 심플 게임 메인 페이지 확인
- [ ] 마이페이지 확인
- [ ] 실제 게임 플레이 테스트

---

## 📞 추가 지원

문제가 발생하면:
1. `server.log` 파일 확인: `tail -50 server.log`
2. DB 파일 확인: `ls -lh faith-portal.db`
3. 프로세스 확인: `ps aux | grep node`

---

**중요**: 이 작업은 **프로덕션 서버에서만** 실행하세요!
샌드박스는 이미 정리되었습니다.

GitHub 커밋: `0f7419b - Add script to clean production database from mock data`
