# ë§ˆì´í˜ì´ì§€ ê²Œì„ ê¸°ë¡ í‘œì‹œ ë¬¸ì œ ìˆ˜ì •

## ğŸ› ë¬¸ì œ ìƒí™©

### ì¦ìƒ
- ìŠ¤ë„ì¿  ê²Œì„ì„ ì™„ë£Œí•˜ê³  ì ìˆ˜ë¥¼ ì €ì¥í•¨
- ì ìˆ˜ ì €ì¥ì€ ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ
- **ë§ˆì´í˜ì´ì§€ì—ì„œ ê²Œì„ ê¸°ë¡ì´ í‘œì‹œë˜ì§€ ì•ŠìŒ**

### ì›ì¸ ë¶„ì„

#### 1. í…Œì´ë¸” ë¶„ë¦¬ ë¬¸ì œ
```
ìŠ¤ë„ì¿  ì ìˆ˜ ì €ì¥ â†’ sudoku_scores í…Œì´ë¸”ë§Œ ì €ì¥
ë§ˆì´í˜ì´ì§€ API â†’ user_game_scores í…Œì´ë¸”ë§Œ ì¡°íšŒ
â†’ ê²°ê³¼: ë°ì´í„° ë¶ˆì¼ì¹˜
```

#### 2. í•˜ë“œì½”ë”©ëœ ê²Œì„ ëª©ë¡
```typescript
// âŒ ê¸°ì¡´ ì½”ë“œ
const games = ['tetris', 'snake', '2048', 'minesweeper']
// sudokuê°€ ëª©ë¡ì— ì—†ìŒ!
```

#### 3. getGameHistory íŒŒë¼ë¯¸í„° ë²„ê·¸
```typescript
// âŒ ì˜ëª»ëœ ì½”ë“œ
const limit = parseInt(c.req.query('limit') || '20')
const history = await service.getGameHistory(user.id, gameType, limit)
// ì„¸ ë²ˆì§¸ íŒŒë¼ë¯¸í„°ëŠ” pageì¸ë° limitì„ ì „ë‹¬
```

**ê²°ê³¼**: `?limit=10` â†’ `page=10`ìœ¼ë¡œ í•´ì„ â†’ offset=90 â†’ ë°ì´í„° ì—†ìŒ

---

## âœ… í•´ê²° ë°©ë²•

### 1. ìŠ¤ë„ì¿  ì ìˆ˜ë¥¼ ë‘ í…Œì´ë¸”ì— ëª¨ë‘ ì €ì¥

#### sudoku_scores í…Œì´ë¸” (ê¸°ì¡´)
- ìš©ë„: ìŠ¤ë„ì¿  ì „ìš© ë¦¬ë”ë³´ë“œ
- ë°ì´í„°: difficulty, time, mistakes, player_name

#### user_game_scores í…Œì´ë¸” (ì¶”ê°€)
- ìš©ë„: ë§ˆì´í˜ì´ì§€ í†µí•© í‘œì‹œ
- ë°ì´í„°: game_type='sudoku', score (ê³„ì‚°ëœ ì ìˆ˜), game_data

#### ì ìˆ˜ ê³„ì‚° ë¡œì§
```typescript
// ê¸°ë³¸ ì ìˆ˜ = 10000 - (ì‹œê°„ì´ˆ * 10) - (ì‹¤ìˆ˜ * 100)
const baseScore = Math.max(0, 10000 - (time * 10) - (mistakes * 100))

// ë‚œì´ë„ ê°€ì¤‘ì¹˜
const multiplier = {
  easy: 1.0,
  medium: 1.5,
  hard: 2.0
}

// ìµœì¢… ì ìˆ˜
const finalScore = Math.round(baseScore * multiplier)
```

**ì˜ˆì‹œ**:
- Medium, 180ì´ˆ, 5ì‹¤ìˆ˜
- ê¸°ë³¸: 10000 - 1800 - 500 = 7700
- ìµœì¢…: 7700 * 1.5 = **11550ì **

### 2. getGameStatsì— sudoku ì¶”ê°€

```typescript
// âœ… ìˆ˜ì •ëœ ì½”ë“œ
const games = ['tetris', 'snake', '2048', 'minesweeper', 'sudoku']
```

### 3. getGameHistory íŒŒë¼ë¯¸í„° ìˆ˜ì •

```typescript
// âœ… ì˜¬ë°”ë¥¸ ì½”ë“œ
const page = parseInt(c.req.query('page') || '1')
const limit = parseInt(c.req.query('limit') || '20')
const history = await service.getGameHistory(user.id, gameType, page, limit)
```

### 4. ë””ë²„ê¹… ë¡œê·¸ ì¶”ê°€

#### í”„ë¡ íŠ¸ì—”ë“œ (ë§ˆì´í˜ì´ì§€)
```javascript
console.log('ğŸ® [ë§ˆì´í˜ì´ì§€ í”„ë¡ íŠ¸] ê²Œì„ ë°ì´í„° ë¡œë”© ì‹œì‘...')
console.log('ğŸ“¡ [ë§ˆì´í˜ì´ì§€ í”„ë¡ íŠ¸] API ìš”ì²­: /api/user/games/stats')
console.log('ğŸ“¦ [ë§ˆì´í˜ì´ì§€ í”„ë¡ íŠ¸] í†µê³„ ì‘ë‹µ:', statsRes.data)
console.log('ğŸ“Š [ë§ˆì´í˜ì´ì§€ í”„ë¡ íŠ¸] íŒŒì‹±ëœ í†µê³„:', stats)
console.log('ğŸ”‘ [ë§ˆì´í˜ì´ì§€ í”„ë¡ íŠ¸] í†µê³„ í‚¤ ëª©ë¡:', statsKeys)
```

#### ë°±ì—”ë“œ (MyPageService)
```typescript
console.log('ğŸ® [ë§ˆì´í˜ì´ì§€] getGameStats í˜¸ì¶œ:', { userId })
console.log('ğŸ” [ë§ˆì´í˜ì´ì§€] sudoku í†µê³„ ì¡°íšŒ ì¤‘...')
console.log('ğŸ“Š [ë§ˆì´í˜ì´ì§€] sudoku ê²°ê³¼:', result)
console.log('ğŸ† [ë§ˆì´í˜ì´ì§€] sudoku ìˆœìœ„:', { rank, totalPlayers, percentile })
```

#### ìŠ¤ë„ì¿  ì ìˆ˜ ì €ì¥ API
```typescript
console.log('ğŸ’¾ [ìŠ¤ë„ì¿ ] DB ì €ì¥ ì‹œì‘...')
console.log('âœ… [ìŠ¤ë„ì¿ ] sudoku_scores í…Œì´ë¸” ì €ì¥ ì„±ê³µ')
console.log('ğŸ“Š [ìŠ¤ë„ì¿ ] ì ìˆ˜ ê³„ì‚°:', { time, mistakes, difficulty, finalScore })
console.log('âœ… [ìŠ¤ë„ì¿ ] user_game_scores í…Œì´ë¸” ì €ì¥ ì„±ê³µ')
```

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ê²°ê³¼

### 1. ìŠ¤ë„ì¿  ì ìˆ˜ ì €ì¥
```bash
curl -X POST http://localhost:3000/api/sudoku/score \
  -b cookies.txt \
  -H "Content-Type: application/json" \
  -d '{"difficulty":"medium","time":180,"mistakes":5}'
```

**ì‘ë‹µ**:
```json
{
  "success": true,
  "message": "ê¸°ë¡ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤",
  "score": 11550
}
```

**ì„œë²„ ë¡œê·¸**:
```
ğŸ’¾ [ìŠ¤ë„ì¿ ] DB ì €ì¥ ì‹œì‘...
âœ… [ìŠ¤ë„ì¿ ] sudoku_scores í…Œì´ë¸” ì €ì¥ ì„±ê³µ
ğŸ“Š [ìŠ¤ë„ì¿ ] ì ìˆ˜ ê³„ì‚°: {
  time: 180,
  mistakes: 5,
  difficulty: 'medium',
  difficultyMultiplier: 1.5,
  baseScore: 7700,
  finalScore: 11550
}
âœ… [ìŠ¤ë„ì¿ ] user_game_scores í…Œì´ë¸” ì €ì¥ ì„±ê³µ
```

### 2. ë§ˆì´í˜ì´ì§€ ê²Œì„ í†µê³„ API
```bash
curl -b cookies.txt http://localhost:3000/api/user/games/stats
```

**ì‘ë‹µ**:
```json
{
  "success": true,
  "stats": {
    "sudoku": {
      "best_score": 11550,
      "average_score": 11550,
      "play_count": 1,
      "rank": 1,
      "percentile": 100,
      "last_played": "2026-01-27 16:00:25"
    }
  }
}
```

**ì„œë²„ ë¡œê·¸**:
```
ğŸ® [ë§ˆì´í˜ì´ì§€] getGameStats í˜¸ì¶œ: { userId: 5 }
ğŸ” [ë§ˆì´í˜ì´ì§€] sudoku í†µê³„ ì¡°íšŒ ì¤‘...
ğŸ“Š [ë§ˆì´í˜ì´ì§€] sudoku ê²°ê³¼: {
  best_score: 11550,
  average_score: 11550,
  play_count: 1,
  last_played: '2026-01-27 16:00:25'
}
ğŸ† [ë§ˆì´í˜ì´ì§€] sudoku ìˆœìœ„: {
  rank: 1,
  totalPlayers: 1,
  percentile: '100.0'
}
```

### 3. ë§ˆì´í˜ì´ì§€ ê²Œì„ íˆìŠ¤í† ë¦¬ API
```bash
curl -b cookies.txt "http://localhost:3000/api/user/games/history?limit=10"
```

**ì‘ë‹µ**:
```json
{
  "success": true,
  "history": {
    "history": [
      {
        "id": 5,
        "user_id": 5,
        "game_type": "sudoku",
        "score": 11550,
        "game_data": "{\"difficulty\":\"medium\",\"time\":180,\"mistakes\":5,\"raw_score\":7700,\"multiplier\":1.5}",
        "played_at": "2026-01-27 16:00:25"
      }
    ],
    "total": 1
  }
}
```

**ì„œë²„ ë¡œê·¸**:
```
ğŸ® [Controller] getGameHistory: {
  userId: 5,
  gameType: undefined,
  page: 1,
  limit: 10
}
ğŸ“œ [ë§ˆì´í˜ì´ì§€] getGameHistory í˜¸ì¶œ: {
  userId: 5,
  gameType: undefined,
  page: 1,
  limit: 10
}
ğŸ” [ë§ˆì´í˜ì´ì§€] SQL ì¿¼ë¦¬: WHERE user_id = ?
ğŸ“Š [ë§ˆì´í˜ì´ì§€] íˆìŠ¤í† ë¦¬ ì¡°íšŒ ê²°ê³¼: { count: 1, total: 1 }
ğŸ® [ë§ˆì´í˜ì´ì§€] íˆìŠ¤í† ë¦¬ ìƒì„¸: [ {...} ]
```

---

## ğŸ“Š ë°ì´í„° íë¦„ (ìˆ˜ì • í›„)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ìŠ¤ë„ì¿  ê²Œì„     â”‚
â”‚  ì™„ë£Œ (ì ìˆ˜ì €ì¥) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  POST /api/sudoku/score                 â”‚
â”‚  { difficulty, time, mistakes }         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â–¼                 â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ sudoku_scores    â”‚  â”‚ ì ìˆ˜ ê³„ì‚°        â”‚  â”‚ game_data    â”‚
â”‚ í…Œì´ë¸” ì €ì¥       â”‚  â”‚ baseScore       â”‚  â”‚ JSON ìƒì„±    â”‚
â”‚                  â”‚  â”‚ * multiplier    â”‚  â”‚              â”‚
â”‚ difficulty       â”‚  â”‚ = finalScore    â”‚  â”‚ difficulty   â”‚
â”‚ time             â”‚  â”‚                 â”‚  â”‚ time         â”‚
â”‚ mistakes         â”‚  â”‚                 â”‚  â”‚ mistakes     â”‚
â”‚ player_name      â”‚  â”‚                 â”‚  â”‚ raw_score    â”‚
â”‚ user_id          â”‚  â”‚                 â”‚  â”‚ multiplier   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚                  â”‚
                               â–¼                  â–¼
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚  user_game_scores           â”‚
                      â”‚  í…Œì´ë¸” ì €ì¥                 â”‚
                      â”‚                             â”‚
                      â”‚  user_id                    â”‚
                      â”‚  game_type = 'sudoku'       â”‚
                      â”‚  score = finalScore         â”‚
                      â”‚  game_data = JSON.stringify â”‚
                      â”‚  played_at                  â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚  ë§ˆì´í˜ì´ì§€ ì¡°íšŒ           â”‚
                      â”‚  GET /api/user/games/statsâ”‚
                      â”‚  GET /api/user/games/historyâ”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚  âœ… í†µê³„ í‘œì‹œ             â”‚
                      â”‚  - ìµœê³  ì ìˆ˜: 11550      â”‚
                      â”‚  - í”Œë ˆì´ íšŸìˆ˜: 1        â”‚
                      â”‚  - ìˆœìœ„: 1ìœ„             â”‚
                      â”‚                          â”‚
                      â”‚  âœ… íˆìŠ¤í† ë¦¬ í‘œì‹œ         â”‚
                      â”‚  - sudoku / 11550ì       â”‚
                      â”‚  - 2026-01-27            â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” ë””ë²„ê¹… ê°€ì´ë“œ

### ë¸Œë¼ìš°ì € ì½˜ì†” (F12)
ë§ˆì´í˜ì´ì§€ ê²Œì„ íƒ­ í´ë¦­ ì‹œ:
```
ğŸ® [ë§ˆì´í˜ì´ì§€ í”„ë¡ íŠ¸] ê²Œì„ ë°ì´í„° ë¡œë”© ì‹œì‘...
ğŸ“¡ [ë§ˆì´í˜ì´ì§€ í”„ë¡ íŠ¸] API ìš”ì²­: /api/user/games/stats
ğŸ“¦ [ë§ˆì´í˜ì´ì§€ í”„ë¡ íŠ¸] í†µê³„ ì‘ë‹µ: {success: true, stats: {...}}
ğŸ“Š [ë§ˆì´í˜ì´ì§€ í”„ë¡ íŠ¸] íŒŒì‹±ëœ í†µê³„: {sudoku: {...}}
ğŸ”‘ [ë§ˆì´í˜ì´ì§€ í”„ë¡ íŠ¸] í†µê³„ í‚¤ ëª©ë¡: ['sudoku']
âœ… [ë§ˆì´í˜ì´ì§€ í”„ë¡ íŠ¸] ê²Œì„ ë°ì´í„° ë¡œë”© ì™„ë£Œ
```

### PM2 ë¡œê·¸
```bash
pm2 logs webapp --nostream | grep "ë§ˆì´í˜ì´ì§€"
```

ì¶œë ¥:
```
ğŸ® [ë§ˆì´í˜ì´ì§€] getGameStats í˜¸ì¶œ
ğŸ” [ë§ˆì´í˜ì´ì§€] sudoku í†µê³„ ì¡°íšŒ ì¤‘...
ğŸ“Š [ë§ˆì´í˜ì´ì§€] sudoku ê²°ê³¼: {...}
ğŸ† [ë§ˆì´í˜ì´ì§€] sudoku ìˆœìœ„: {...}
âœ… [ë§ˆì´í˜ì´ì§€] ì „ì²´ í†µê³„: {...}
```

---

## ğŸ“ ìˆ˜ì •ëœ íŒŒì¼

1. **src/index.tsx**
   - ë¼ì¸ 5119~5180: ìŠ¤ë„ì¿  ì ìˆ˜ ì €ì¥ ë¡œì§ (ë‘ í…Œì´ë¸” ì €ì¥)
   - ë¼ì¸ 20697~20790: loadGamesData() í”„ë¡ íŠ¸ì—”ë“œ ë””ë²„ê¹…

2. **src/services/mypage.service.ts**
   - ë¼ì¸ 374~437: getGameStats() - sudoku ì¶”ê°€ ë° ë””ë²„ê¹…
   - ë¼ì¸ 519~561: getGameHistory() - ë””ë²„ê¹… ë¡œê·¸ ì¶”ê°€

3. **src/controllers/mypage.controller.ts**
   - ë¼ì¸ 509~533: getGameHistory() - page íŒŒë¼ë¯¸í„° ìˆ˜ì •

---

## ğŸ“ˆ ì ìˆ˜ ê³„ì‚° ì˜ˆì‹œ

| Difficulty | Time | Mistakes | Base Score | Multiplier | Final Score |
|------------|------|----------|------------|------------|-------------|
| Easy | 120s | 3 | 10000 - 1200 - 300 = 8500 | 1.0 | **8500** |
| Medium | 180s | 5 | 10000 - 1800 - 500 = 7700 | 1.5 | **11550** |
| Hard | 240s | 8 | 10000 - 2400 - 800 = 6800 | 2.0 | **13600** |
| Easy | 60s | 0 | 10000 - 600 - 0 = 9400 | 1.0 | **9400** |

**ê·œì¹™**:
- ì‹œê°„ì´ ì§§ì„ìˆ˜ë¡ ë†’ì€ ì ìˆ˜
- ì‹¤ìˆ˜ê°€ ì ì„ìˆ˜ë¡ ë†’ì€ ì ìˆ˜
- ë‚œì´ë„ê°€ ë†’ì„ìˆ˜ë¡ ì ìˆ˜ ë°°ìœ¨ ì¦ê°€

---

## âœ… ì™„ë£Œ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [x] ìŠ¤ë„ì¿  ì ìˆ˜ ë‘ í…Œì´ë¸” ì €ì¥
- [x] ì ìˆ˜ ê³„ì‚° ë¡œì§ êµ¬í˜„
- [x] sudokuë¥¼ ê²Œì„ ëª©ë¡ì— ì¶”ê°€
- [x] getGameHistory íŒŒë¼ë¯¸í„° ë²„ê·¸ ìˆ˜ì •
- [x] í”„ë¡ íŠ¸ì—”ë“œ ë””ë²„ê¹… ë¡œê·¸
- [x] ë°±ì—”ë“œ ë””ë²„ê¹… ë¡œê·¸
- [x] API í…ŒìŠ¤íŠ¸ ì™„ë£Œ
- [x] ë§ˆì´í˜ì´ì§€ í‘œì‹œ í™•ì¸

---

## ğŸŒ í…ŒìŠ¤íŠ¸ URL

**ë§ˆì´í˜ì´ì§€**: https://3000-igqqzgkeu63c4u9ihulwt-c81df28e.sandbox.novita.ai/mypage

**í…ŒìŠ¤íŠ¸ ë°©ë²•**:
1. ë¡œê·¸ì¸
2. ìŠ¤ë„ì¿  ê²Œì„ í”Œë ˆì´ ë° ì™„ë£Œ
3. ë§ˆì´í˜ì´ì§€ â†’ ê²Œì„ íƒ­ í´ë¦­
4. ê²Œì„ í†µê³„ ë° íˆìŠ¤í† ë¦¬ í™•ì¸
5. F12 â†’ Console íƒ­ì—ì„œ ë””ë²„ê¹… ë¡œê·¸ í™•ì¸

---

**ì‘ì„±ì¼**: 2026-01-27  
**ì‘ì„±ì**: AI Assistant  
**ìƒíƒœ**: âœ… ì™„ë£Œ  
**Git ì»¤ë°‹**: f438b39
